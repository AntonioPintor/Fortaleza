(function(g){function f(){return"onhashchange" in window}function l(){k=document.location.hash,window.onhashchange=c}function c(m,e){var a=k;k=document.location.hash,g(window).trigger("jQuery.hashchange",{before:a,after:k})}function j(a){k==null&&(k=document.location.hash),d!=null&&clearInterval(d),b!=a.interval&&(d=setInterval(h,a.interval),b=a.interval)}function h(){if(k!=document.location.hash){var a=k;k=document.location.hash,g(window).trigger("jQuery.hashchange",{before:a,after:k})}}g.fn.hashchange=function(a){return g(window).bind("jQuery.hashchange",a),this},g.observeHashChange=function(a){var e=g.extend({},g.observeHashChange.defaults,a);f()?l():j(e)};var k=null,d=null,b=0;g.observeHashChange.defaults={interval:500},g.observeHashChange()})(jQuery),function(){window.Imprint=function(){function a(){this.tumblrApiKey="CSR1yqOefOoCj4GAWtTe6twY4kaA6vDt0y59hWXhtFZSaMmluO",$("body").hasClass("development")?(this.blogName="imprint-yaron.tumblr.com",this.imprintURL="https://imprint.dev"):(this.blogName=document.location.host,this.imprintURL="https://literistic.com"),this.replaceWithExcerpt($("[data-excerpt], [data-excerpt-length]")),this.removeExcerpt($("[data-remove-excerpt]")),this.dropCap($("[data-add-drop-cap]")),this.detectArchive(),this.displayPostFooter();try{console.log("Imprint: For Writers. For Writing.")}catch(b){}}return a.prototype.formatDate=function(f){var c,g,d,b;return b=f.split(" ")[0].split("-"),g=["January","February","March","April","May","June","July","August","September","October","November","December"],d=parseInt(b[1].replace(/^[0]+/g,""))-1,c=b[2].replace(/^0/,""),""+g[d]+"&nbsp;"+c+",&nbsp;"+b[0]},a.prototype.generatePostsURL=function(c,b){return"https://api.tumblr.com/v2/blog/"+this.blogName+"/posts?api_key="+this.tumblrApiKey+"&offset="+c+"&limit="+b+"&reblog_info=true&callback&jsonp=?"},a.prototype.detectArchive=function(){var b=this;return $("body").hasClass("loading")&&($("body").hasClass("index")&&this.loadArchivePosts(),$(window).hashchange(function(){return b.toggleArchiveDisplay()})),this.toggleArchiveDisplay()},a.prototype.displayPostFooter=function(){var c,b=this;if($("body").hasClass("post")){return c="https://api.tumblr.com/v2/blog/"+this.blogName+"/posts/text?api_key="+this.tumblrApiKey+"&offset=0&limit=4&callback&jsonp=?",$.getJSON(c,function(d){var f;return f=$(d.response.posts).map(function(g,h){return $("body").hasClass("post-"+h.id)?null:b.constructTextPostHTML(h)}),$(".recent-posts-container").append(f.slice(0,3)),b.replaceWithExcerpt($("[data-excerpt-length]"))})}},a.prototype.toggleArchiveDisplay=function(){return document.location.hash==="#archive"?$("body").hasClass("loading")?($("body").addClass("archive").removeClass("index"),this.loadArchivePosts(),$(window).scrollTop(0)):location.reload():($("body").removeClass("archive"),$("body").hasClass("post")||$("body").addClass("index"),$("body").removeClass("loading"))},a.prototype.loadArchivePosts=function(){var c,b=this;return c=$("#archive-section .archive-container > .archive-item").length,$.getJSON(this.generatePostsURL(c,20),function(f){var e,d;e=f.response.blog.posts,d=f.response.posts,b.addPostsToArchives(d),$("body").removeClass("loading");if(e>c){return b.loadArchivePosts()}})},a.prototype.addPostsToArchives=function(d){var b,f,c=this;return b=$(d).map(function(h,g){return c.constructTextPostHTML(g)}).get(),$("#archive-section .archive-container").append(b),$("#index .archive-container").find(".archive-item.text").length<10&&(f=10-$("#index .archive-container").find(".archive-item.text").length,$("#index .archive-container").append(b.slice(0,f))),this.replaceWithExcerpt($("[data-excerpt-length]"))},a.prototype.constructTextPostHTML=function(b){return console.log('Not defined. Themes should override "Imprint.constructTextPostHTML".')},a.prototype.initializeEmailSubscription=function(){return $("#subscribe-form").ajaxForm({url:""+this.imprintURL+"/subscribers.js?callback=?",type:"GET",dataType:"jsonp",beforeSubmit:this.beforeEmailSubscriptionSubmit,success:this.succesfulEmailSubscriptionSubmit})},a.prototype.beforeEmailSubscriptionSubmit=function(){var b;return b=$("#subscribe-form").validate({onkeyup:!1,onclick:!1,onfocusout:!1,submitHandler:function(){return $("form input[type=submit]").attr("disabled","disabled").text("Submitting...")},invalidHandler:function(){return $("form input[type=submit]").removeAttr("disabled").text("Submit")},messages:{EMAIL:{required:"You must include your email address."}}}),b.form()},a.prototype.succesfulEmailSubscriptionSubmit=function(b){$("#subscribe-modal #response").empty();if(b.result==="success"){return $("#subscribe-form")[0].reset(),$("#subscribe-form").hide(),$("#subscribe-modal #response").html("Thank you for subscribing."),$("#subscribe-modal .modal-footer").show()}},a.prototype.generatePageview=function(){var b;return b=$("#blog-name").val(),$.ajax({url:""+this.imprintURL+"/pageview/"+b+".js?callback=?",type:"GET",dataType:"jsonp"})},a.prototype.dropCap=function(g){var k,d,b,f,l,c,j,h;h=[];for(c=0,j=g.length;c<j;c++){k=g[c],l=$(k).find("p:first"),l.length?(b=$(l).html(),d=b.substring(0,1),$(l).text().match(/\. /g)?f=$(l).text().match(/\. /g).length:f=0,d.match(/[a-zA-Z]/)&&f>1?(b="<span class='drop-cap'>"+d+"</span>"+b.slice(1),h.push($(l).html(b))):h.push(void 0)):h.push(void 0)}return h},a.prototype.removeExcerpt=function(g){var c,j,f,b,d,h;h=[];for(b=0,d=g.length;b<d;b++){j=g[b],f=$(j).html().search(/<!-- more -->/),f>0?(f+=13,c=$(j).html(),$(j).html(c.substring(f,c.length)),$(j).find("p:empty").remove(),h.push(!0)):h.push(!1)}return h},a.prototype.replaceWithExcerpt=function(w){var A,j,b,m,B,g,z,y,v,k,x,q,d;d=[];for(x=0,q=w.length;x<q;x++){j=w[x],g=$(j).html().search(/<!-- more -->/),z=$(j).data("excerpt-length"),v=!1,g>0?A=$(j).html().substring(0,g):$(j).find("p.read_more_container").length?(A=$(j).find("p.read_more_container").prevAll().text(),$(j).find("p.read_more_container").remove()):$(j).data("excerpt-length")?(A=$(j).text(),A.length>z&&(y=!0,A=""+A.slice(0,z+1||9000000000)+"&nbsp;.&nbsp;.&nbsp;.")):$(j).remove(),A?($(j).data("excerpt-strip-html")==="true"&&(A=$("<div />").html(A).text()),$(j).data("excerpt-element")?(b=$("<"+$(j).data("excerpt-element")+" />"),b.html(A)):(b=A.match(/<p/)?$("<div />"):$("<p />"),b.html(A)),k=$(j).data("excerpt-wrap"),b.prepend(k).append(k),y&&$(j).data("read-more-link")&&(B=$(j).data("read-more-link"),B.match(/<p/)?b=""+$(b).prop("outerHTML")+B:b.append(B)),$(j).html(b),d.push(function(){var f,c;c=[];for(m=f=1;f<=3;m=++f){c.push($(j).find("*:empty").remove())}return c}())):d.push(void 0)}return d},a}()}.call(this);
